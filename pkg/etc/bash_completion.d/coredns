#!/bin/bash
# Bash completion for coredns-ctl

_coredns_ctl_completions() {
    local cur="${COMP_WORDS[COMP_CWORD]}"
    local commands="start stop restart reload status logs follow version config validate resolve help"
    
    if [[ ${COMP_CWORD} -eq 1 ]]; then
        COMPREPLY=($(compgen -W "${commands}" -- "$cur"))
    fi
}

_coredns_zone_completions() {
    local cur="${COMP_WORDS[COMP_CWORD]}"
    local prev="${COMP_WORDS[COMP_CWORD-1]}"
    local commands="init bump list show help"
    
    if [[ ${COMP_CWORD} -eq 1 ]]; then
        COMPREPLY=($(compgen -W "${commands}" -- "$cur"))
    elif [[ $prev == "show" ]] || [[ $prev == "bump" ]]; then
        # Complete with zone names
        local zones=$(ls /etc/coredns/*.zone 2>/dev/null | xargs -I {} basename {} .zone)
        COMPREPLY=($(compgen -W "${zones}" -- "$cur"))
    fi
}

_coredns_resolve_completions() {
    local cur="${COMP_WORDS[COMP_CWORD]}"
    local commands="status disable enable check configure help"
    
    if [[ ${COMP_CWORD} -eq 1 ]]; then
        COMPREPLY=($(compgen -W "${commands}" -- "$cur"))
    fi
}

_coredns_validate_completions() {
    local cur="${COMP_WORDS[COMP_CWORD]}"
    
    if [[ ${COMP_CWORD} -eq 1 ]]; then
        COMPREPLY=($(compgen -f -- "$cur"))
    fi
}

complete -F _coredns_ctl_completions coredns-ctl
complete -F _coredns_zone_completions coredns-zone
complete -F _coredns_resolve_completions coredns-resolve
complete -F _coredns_validate_completions coredns-validate
